	ORG 0000H
	AJMP MAIN
	ORG 000BH
	LJMP INTT0
	ORG 0030H
MAIN:
	MOV TMOD,#01H
	MOV TL0,#0AEH
	MOV TH0,#3CH
	SETB EA
	SETB ET0
	SETB TR0
	
	MOV	60H,#00H
	MOV	61H,#00H
	MOV	62H,#00H
	MOV	63H,#00H
	MOV	64H,#00H
	MOV	65H,#00H
	MOV	66H,#00H
	MOV	67H,#00H
		
	MOV P0,#00H
	MOV P1,#00H
	MOV R1,#20;  65535-50000=15534(0x3CAE) == 1s

LOOP:
	ACALL DISPLAY
	SJMP LOOP
	
DISPLAY:
	MOV	R7,#8
	MOV	R0,#60H
	MOV	R6,#01H
	
	MOV	DPTR,#TAB
LOOP3:	
	MOV	A,@R0	
	MOVC A,@A+DPTR
	MOV	P2,A
	MOV	P1,R6
	MOV	A,R6
	RL A
	MOV	R6,A
	ACALL DELAY
	MOV	P1,#00H
	INC	R0
	DJNZ R7,LOOP3
	RET
			
INTT0:
	MOV TL0,#0AEH
	MOV TH0,#03CH
	DJNZ R1,EXIT
	ACALL ADDLED
	MOV R1,#20
	MOV A,P0
	CPL A	 
	MOV P0,A
EXIT:	
	RETI
		
ADDLED:
	INC	67H
	MOV	A,67H
	;; P3.7 Control LED
	CJNE A,#3,NECJNE
	SJMP LED0
NECJNE:
	JC LED37
	CLR P3.7
	SJMP LED0
LED37:
	SETB P3.7
LED0:	
	;; P3.7 END
	CJNE A,#10,EXIT
	MOV	67H,#00H
	
	INC	66H
	MOV	A,66H
	CJNE A,#10,EXIT
	MOV	66H,#00H

	INC	65H
	MOV	A,65H
	CJNE A,#10,EXIT
	MOV	65H,#00H

	RET
	
DELAY: ; delay 1ms
DL0:	
	MOV R3,#0FAH ; 250*4 
DL1:
	NOP
	NOP
	DJNZ R3,DL1
	RET
TAB:
	DB      0C0H, 0F9H, 0A4H, 0B0H  ;0, 1, 2, 3
	DB       99H,  92H,  82H, 0F8H  ;4, 5, 6, 7
	DB       80H,  90H,  88H,  83H  ;8, 9, A, B
	DB      0C6H, 0A1H,  86H,  8EH  ;C, D, E, F
	END